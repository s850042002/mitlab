<!doctype html>
<html>
	<head>
		<title>MITLAB</title>
		<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<script src="bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
		<link href='https://fonts.googleapis.com/css?family=Noto+Sans:400,700' rel='stylesheet' type='text/css'>
        <link rel="import" href="bower_components/iron-ajax/iron-ajax.html">
        <link rel="import" href="bower_components/iron-icons/iron-icons.html">
        <link rel="import" href="bower_components/iron-icons/communication-icons.html">
        <link rel="import" href="bower_components/iron-icons/image-icons.html">
        <link rel="import" href="bower_components/iron-icons/social-icons.html">
        <link rel="import" href="bower_components/iron-icon/iron-icon.html">
        <link rel="import" href="bower_components/paper-drawer-panel/paper-drawer-panel.html">
        <link rel="import" href="bower_components/paper-header-panel/paper-header-panel.html">
        <link rel="import" href="bower_components/paper-toolbar/paper-toolbar.html">
        <link rel="import" href="bower_components/paper-menu/paper-menu.html">
        <link rel="import" href="bower_components/paper-item/paper-icon-item.html">
        <link rel="import" href="bower_components/paper-icon-button/paper-icon-button.html">
		<link rel="import" href="custom_components/lab-content.html">

		<style>
		html, body {
			font-family: 'Noto Sans', sans-serif;
		}
		a{
			text-decoration: none;
		}
		paper-header-panel {
			height: 100%;
			background-color: #ffffff;
		}
		#header-title{
			font-size: 120%;
		}
		#nav-header {
			background-color: #000000;
			color: #ffffff;
            font-size: 1.6rem;
            font-weight: 700;
		}
		#main-header {
			background-color: #00bcd4;
			color: #ffffff;
			font-weight: 500;
			font-size: 150%;
		}
		paper-drawer-panel:not([narrow]) #navicon {
			display: none;
		}
        .menu-item{
            cursor: default;
            margin-bottom: 20px;
        }
		.menu-item-text{
			font-size: 120%;
		}
		</style>

		<script>
            HTMLImports.whenReady(function() {
				var paperDrawerPanel = document.querySelector('paper-drawer-panel');
				var labContent = document.querySelector('lab-content');
                var headerTitle = document.querySelector('#header-title');
                var headerIcon = document.querySelector('#header-icon');
				var drawerPanel = document.querySelector('#drawerPanel');
				var menuItem = document.querySelectorAll('.menu-item');
                var menuItemText = document.querySelectorAll('.menu-item-text');
				var navIcon = document.querySelector('#navicon');
				var langAjax = document.querySelector('#lang-ajax');

				function init(){
					var data = {"lang": "tw"};
					langAjax.params = data;
					langAjax.generateRequest();

					for(i = 0; i < menuItem.length; i++){
						menuItem[i].addEventListener('click', function() {
							paperDrawerPanel.togglePanel();
							var currentPage = this.getAttribute("data-menu");
							headerTitle.textContent = this.childNodes[4].textContent;
							var iconElement = this.getElementsByTagName('iron-icon')[0];
							headerIcon.setAttribute('icon', iconElement.getAttribute("icon"));
							labContent.setAttribute('page', currentPage);
						});
					}

					langAjax.addEventListener('response', function(e){
						var langContent = e.detail.response;
						var menu = langContent['menu'].replace('[', '').replace(']', '').replace(/\'/g, '').split(',');
						for( i= 0; i < menuItemText.length; i++){
							menuItemText[i].textContent = menu[i];
						}
						labContent.content = langContent;
					});

					langAjax.addEventListener('error', function(e){
						console.log(e.detail.response);
					});

					navIcon.addEventListener('click', function() {
						drawerPanel.togglePanel();
					});
				}

				init();

				/*langButton.addEventListener('click', function(e) {
					currentLang = (currentLang === "en") ? "tw" : "en";
					var data = {"lang": currentLang};
					langAjax.params = data;
					langAjax.generateRequest();
				});*/
			});
		</script>
	</head>

	<body>
		<iron-ajax id="lang-ajax" url="lang" handleAs="json"></iron-ajax>

		<paper-drawer-panel id="drawerPanel" responsive-width="800px">
			<paper-header-panel drawer mode="seamed">
				<paper-toolbar id="nav-header">
                    <div>MITLAB</div>
                </paper-toolbar>

				<paper-menu selected="0">
					<paper-icon-item class="menu-item" data-menu="about">
                        <div class="menu-item-text"></div>
                        <iron-icon icon="info" item-icon></iron-icon>
                    </paper-icon-item>
                    <paper-icon-item class="menu-item" data-menu="news">
                        <div class="menu-item-text"></div>
                        <iron-icon icon="event" item-icon></iron-icon>
                    </paper-icon-item>
                    <paper-icon-item class="menu-item" data-menu="professor">
                        <div class="menu-item-text"></div>
                        <iron-icon icon="image:portrait" item-icon></iron-icon>
                    </paper-icon-item>
                    <paper-icon-item class="menu-item" data-menu="members">
                        <div class="menu-item-text"></div>
                        <iron-icon icon="social:group" item-icon></iron-icon>
                    </paper-icon-item>
                    <paper-icon-item class="menu-item" data-menu="publications">
                        <div class="menu-item-text"></div>
                        <iron-icon icon="social:public" item-icon></iron-icon>
                    </paper-icon-item>
                    <paper-icon-item class="menu-item" data-menu="projects">
                        <div class="menu-item-text"></div>
                        <iron-icon icon="work" item-icon></iron-icon>
                    </paper-icon-item>
                    <paper-icon-item class="menu-item" data-menu="contact">
                        <div class="menu-item-text"></div>
                        <iron-icon icon="communication:contacts" item-icon></iron-icon>
                    </paper-icon-item>
				</paper-menu>
			</paper-header-panel>

			<paper-header-panel main mode="seamed">
				<paper-toolbar id="main-header">
					<paper-icon-button id="navicon" icon="menu"></paper-icon-button>
                    <paper-icon-item id="header-bar" data-menu="about">
                        <div id="header-title"></div>
                        <iron-icon id="header-icon" icon="info" item-icon></iron-icon>
                    </paper-icon-item>
				</paper-toolbar>
                <lab-content></lab-content>
			</paper-header-panel>
		</paper-drawer-panel>
	</body>
</html>
